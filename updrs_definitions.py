"""
UPDRS Part III (MDS-UPDRS) 評価項目の定義
"""

# UPDRS Part III の評価項目定義
UPDRS_ITEMS = {
    "3.1": {
        "name": "言語（Speech）",
        "description": "自由会話を聞き、必要に応じて会話を行う。音量、抑揚、明瞭さを評価",
        "scores": {
            0: "正常：言語に問題なし",
            1: "軽度：抑揚、発音、音量の低下があるが、すべての単語は理解しやすい",
            2: "軽度：抑揚、発音、音量の低下があり、いくつかの単語が不明瞭だが、全体的な文は理解しやすい",
            3: "中等度：言語が理解しにくく、一部ではあるが大部分ではない文が理解困難",
            4: "重度：言語の大部分が理解困難または理解不能"
        }
    },
    "3.2": {
        "name": "顔面表情（Facial Expression）",
        "description": "安静時に10秒間観察、会話中も観察。瞬きの頻度、仮面様顔貌、自発的な笑顔、口唇の開きを観察",
        "scores": {
            0: "正常：正常な顔面表情",
            1: "軽度：瞬きの頻度の減少のみで現れる最小限の仮面様顔貌",
            2: "軽度：瞬きの頻度の減少に加えて、下顔面にも仮面様顔貌が存在（口周囲の動きの減少、自発的な笑顔の減少など）、ただし口唇は開いていない",
            3: "中等度：口が安静時に時々開いている仮面様顔貌",
            4: "重度：口が安静時にほとんどの時間開いている仮面様顔貌"
        }
    },
    "3.3_neck": {
        "name": "固縮 - 頸部（Rigidity - Neck）",
        "description": "患者をリラックスさせ、主要関節をゆっくりと受動的に動かして判定。まず活性化操作なしで検査",
        "scores": {
            0: "正常：固縮なし",
            1: "軽度：活性化操作でのみ固縮が検出される",
            2: "軽度：活性化操作なしで固縮が検出されるが、可動域全体は容易に達成される",
            3: "中等度：活性化操作なしで固縮が検出され、可動域全体は努力して達成される",
            4: "重度：活性化操作なしで固縮が検出され、可動域全体が達成されない"
        }
    },
    "3.3_rue": {
        "name": "固縮 - 右上肢（Rigidity - RUE）",
        "description": "手首と肘関節を同時に検査",
        "scores": {
            0: "正常：固縮なし",
            1: "軽度：活性化操作でのみ固縮が検出される",
            2: "軽度：活性化操作なしで固縮が検出されるが、可動域全体は容易に達成される",
            3: "中等度：活性化操作なしで固縮が検出され、可動域全体は努力して達成される",
            4: "重度：活性化操作なしで固縮が検出され、可動域全体が達成されない"
        }
    },
    "3.3_lue": {
        "name": "固縮 - 左上肢（Rigidity - LUE）",
        "description": "手首と肘関節を同時に検査",
        "scores": {
            0: "正常：固縮なし",
            1: "軽度：活性化操作でのみ固縮が検出される",
            2: "軽度：活性化操作なしで固縮が検出されるが、可動域全体は容易に達成される",
            3: "中等度：活性化操作なしで固縮が検出され、可動域全体は努力して達成される",
            4: "重度：活性化操作なしで固縮が検出され、可動域全体が達成されない"
        }
    },
    "3.3_rle": {
        "name": "固縮 - 右下肢（Rigidity - RLE）",
        "description": "股関節と膝関節を同時に検査",
        "scores": {
            0: "正常：固縮なし",
            1: "軽度：活性化操作でのみ固縮が検出される",
            2: "軽度：活性化操作なしで固縮が検出されるが、可動域全体は容易に達成される",
            3: "中等度：活性化操作なしで固縮が検出され、可動域全体は努力して達成される",
            4: "重度：活性化操作なしで固縮が検出され、可動域全体が達成されない"
        }
    },
    "3.3_lle": {
        "name": "固縮 - 左下肢（Rigidity - LLE）",
        "description": "股関節と膝関節を同時に検査",
        "scores": {
            0: "正常：固縮なし",
            1: "軽度：活性化操作でのみ固縮が検出される",
            2: "軽度：活性化操作なしで固縮が検出されるが、可動域全体は容易に達成される",
            3: "中等度：活性化操作なしで固縮が検出され、可動域全体は努力して達成される",
            4: "重度：活性化操作なしで固縮が検出され、可動域全体が達成されない"
        }
    },
    "3.4_r": {
        "name": "指タッピング - 右手（Finger Tapping - Right）",
        "description": "人差し指を親指にできるだけ速く、大きく10回タップ。速度、振幅、躊躇、停止、振幅の減衰を評価",
        "scores": {
            0: "正常：問題なし",
            1: "軽度：以下のいずれか：a)1-2回の中断や躊躇、b)軽度の緩慢、c)10回の終わり近くで振幅が減衰",
            2: "軽度：以下のいずれか：a)3-5回の中断、b)軽度の緩慢、c)10回の中間で振幅が減衰",
            3: "中等度：以下のいずれか：a)5回以上の中断または1回以上の長い停止、b)中等度の緩慢、c)1回目のタップ後から振幅が減衰",
            4: "重度：緩慢、中断、減衰のため課題をほとんどまたは全く遂行できない"
        }
    },
    "3.4_l": {
        "name": "指タッピング - 左手（Finger Tapping - Left）",
        "description": "人差し指を親指にできるだけ速く、大きく10回タップ。速度、振幅、躊躇、停止、振幅の減衰を評価",
        "scores": {
            0: "正常：問題なし",
            1: "軽度：以下のいずれか：a)1-2回の中断や躊躇、b)軽度の緩慢、c)10回の終わり近くで振幅が減衰",
            2: "軽度：以下のいずれか：a)3-5回の中断、b)軽度の緩慢、c)10回の中間で振幅が減衰",
            3: "中等度：以下のいずれか：a)5回以上の中断または1回以上の長い停止、b)中等度の緩慢、c)1回目のタップ後から振幅が減衰",
            4: "重度：緩慢、中断、減衰のため課題をほとんどまたは全く遂行できない"
        }
    },
    "3.5_r": {
        "name": "手の動作 - 右手（Hand Movements - Right）",
        "description": "肘を曲げて手を握り、できるだけ速く、大きく10回開閉。速度、振幅、躊躇、停止、振幅の減衰を評価",
        "scores": {
            0: "正常：問題なし",
            1: "軽度：以下のいずれか：a)1-2回の中断や躊躇、b)軽度の緩慢、c)課題の終わり近くで振幅が減衰",
            2: "軽度：以下のいずれか：a)3-5回の中断、b)軽度の緩慢、c)課題の中間で振幅が減衰",
            3: "中等度：以下のいずれか：a)5回以上の中断または1回以上の長い停止、b)中等度の緩慢、c)1回目の開閉後から振幅が減衰",
            4: "重度：緩慢、中断、減衰のため課題をほとんどまたは全く遂行できない"
        }
    },
    "3.5_l": {
        "name": "手の動作 - 左手（Hand Movements - Left）",
        "description": "肘を曲げて手を握り、できるだけ速く、大きく10回開閉。速度、振幅、躊躇、停止、振幅の減衰を評価",
        "scores": {
            0: "正常：問題なし",
            1: "軽度：以下のいずれか：a)1-2回の中断や躊躇、b)軽度の緩慢、c)課題の終わり近くで振幅が減衰",
            2: "軽度：以下のいずれか：a)3-5回の中断、b)軽度の緩慢、c)課題の中間で振幅が減衰",
            3: "中等度：以下のいずれか：a)5回以上の中断または1回以上の長い停止、b)中等度の緩慢、c)1回目の開閉後から振幅が減衰",
            4: "重度：緩慢、中断、減衰のため課題をほとんどまたは全く遂行できない"
        }
    },
    "3.6_r": {
        "name": "回内回外運動 - 右手（Pronation-Supination - Right）",
        "description": "腕を前方に伸ばし、手のひらを下に向け、できるだけ速く、大きく10回回内回外",
        "scores": {
            0: "正常：問題なし",
            1: "軽度：以下のいずれか：a)1-2回の中断や躊躇、b)軽度の緩慢、c)動作の終わり近くで振幅が減衰",
            2: "軽度：以下のいずれか：a)3-5回の中断、b)軽度の緩慢、c)動作の中間で振幅が減衰",
            3: "中等度：以下のいずれか：a)5回以上の中断または1回以上の長い停止、b)中等度の緩慢、c)1回目の回内回外後から振幅が減衰",
            4: "重度：緩慢、中断、減衰のため課題をほとんどまたは全く遂行できない"
        }
    },
    "3.6_l": {
        "name": "回内回外運動 - 左手（Pronation-Supination - Left）",
        "description": "腕を前方に伸ばし、手のひらを下に向け、できるだけ速く、大きく10回回内回外",
        "scores": {
            0: "正常：問題なし",
            1: "軽度：以下のいずれか：a)1-2回の中断や躊躇、b)軽度の緩慢、c)動作の終わり近くで振幅が減衰",
            2: "軽度：以下のいずれか：a)3-5回の中断、b)軽度の緩慢、c)動作の中間で振幅が減衰",
            3: "中等度：以下のいずれか：a)5回以上の中断または1回以上の長い停止、b)中等度の緩慢、c)1回目の回内回外後から振幅が減衰",
            4: "重度：緩慢、中断、減衰のため課題をほとんどまたは全く遂行できない"
        }
    },
    "3.7_r": {
        "name": "つま先タッピング - 右足（Toe Tapping - Right）",
        "description": "踵を床につけ、つま先をできるだけ大きく、速く10回タップ",
        "scores": {
            0: "正常：問題なし",
            1: "軽度：以下のいずれか：a)1-2回の中断や躊躇、b)軽度の緩慢、c)10回の終わり近くで振幅が減衰",
            2: "軽度：以下のいずれか：a)3-5回の中断、b)軽度の緩慢、c)課題の中間で振幅が減衰",
            3: "中等度：以下のいずれか：a)5回以上の中断または1回以上の長い停止、b)中等度の緩慢、c)1回目のタップ後から振幅が減衰",
            4: "重度：緩慢、中断、減衰のため課題をほとんどまたは全く遂行できない"
        }
    },
    "3.7_l": {
        "name": "つま先タッピング - 左足（Toe Tapping - Left）",
        "description": "踵を床につけ、つま先をできるだけ大きく、速く10回タップ",
        "scores": {
            0: "正常：問題なし",
            1: "軽度：以下のいずれか：a)1-2回の中断や躊躇、b)軽度の緩慢、c)10回の終わり近くで振幅が減衰",
            2: "軽度：以下のいずれか：a)3-5回の中断、b)軽度の緩慢、c)課題の中間で振幅が減衰",
            3: "中等度：以下のいずれか：a)5回以上の中断または1回以上の長い停止、b)中等度の緩慢、c)1回目のタップ後から振幅が減衰",
            4: "重度：緩慢、中断、減衰のため課題をほとんどまたは全く遂行できない"
        }
    },
    "3.8_r": {
        "name": "下肢の敏捷性 - 右足（Leg Agility - Right）",
        "description": "足を床につけ、できるだけ高く、速く10回挙上し踏みつける",
        "scores": {
            0: "正常：問題なし",
            1: "軽度：以下のいずれか：a)1-2回の中断や躊躇、b)軽度の緩慢、c)課題の終わり近くで振幅が減衰",
            2: "軽度：以下のいずれか：a)3-5回の中断、b)軽度の緩慢、c)課題の中間で振幅が減衰",
            3: "中等度：以下のいずれか：a)5回以上の中断または1回以上の長い停止、b)中等度の速度低下、c)1回目のタップ後から振幅が減衰",
            4: "重度：緩慢、中断、減衰のため課題をほとんどまたは全く遂行できない"
        }
    },
    "3.8_l": {
        "name": "下肢の敏捷性 - 左足（Leg Agility - Left）",
        "description": "足を床につけ、できるだけ高く、速く10回挙上し踏みつける",
        "scores": {
            0: "正常：問題なし",
            1: "軽度：以下のいずれか：a)1-2回の中断や躊躇、b)軽度の緩慢、c)課題の終わり近くで振幅が減衰",
            2: "軽度：以下のいずれか：a)3-5回の中断、b)軽度の緩慢、c)課題の中間で振幅が減衰",
            3: "中等度：以下のいずれか：a)5回以上の中断または1回以上の長い停止、b)中等度の速度低下、c)1回目のタップ後から振幅が減衰",
            4: "重度：緩慢、中断、減衰のため課題をほとんどまたは全く遂行できない"
        }
    },
    "3.9": {
        "name": "椅子からの立ち上がり（Arising from Chair）",
        "description": "背もたれのある椅子に座り、腕を胸の前で組んで立ち上がる。最大3回まで試行可能",
        "scores": {
            0: "正常：問題なし。躊躇なく素早く立ち上がることができる",
            1: "軽度：立ち上がりが正常より遅い、または複数回の試行が必要、または椅子で前方に移動して立ち上がる必要がある。腕の使用は不要",
            2: "軽度：椅子の肘掛けを押して困難なく立ち上がる",
            3: "中等度：押す必要があるが、後ろに倒れる傾向がある、または肘掛けを使って複数回試行するが、助けなしで立ち上がることができる",
            4: "重度：助けなしでは立ち上がることができない"
        }
    },
    "3.10": {
        "name": "歩行（Gait）",
        "description": "少なくとも10メートル（30フィート）歩き、振り向いて戻る。歩幅、速度、足の挙上、踵接地、方向転換、腕振りを評価",
        "scores": {
            0: "正常：問題なし",
            1: "軽度：軽度の歩行障害があるが自立歩行",
            2: "軽度：実質的な歩行障害があるが自立歩行",
            3: "中等度：安全な歩行のために補助具（杖、歩行器）が必要だが、人の助けは不要",
            4: "重度：全く歩けない、または他人の助けがあってのみ歩ける"
        }
    },
    "3.11": {
        "name": "歩行時のすくみ足（Freezing of Gait）",
        "description": "歩行評価中にすくみ足の有無を観察。開始時の躊躇、方向転換時、ドア通過時の足踏み様運動を観察",
        "scores": {
            0: "正常：すくみなし",
            1: "軽度：開始時、方向転換時、またはドア通過時に1回の停止があるが、直線歩行ではすくみなしで円滑に継続",
            2: "軽度：開始時、方向転換時、またはドア通過時に複数回の停止があるが、直線歩行ではすくみなしで継続",
            3: "中等度：直線歩行中に1回すくむ",
            4: "重度：直線歩行中に複数回すくむ"
        }
    },
    "3.12": {
        "name": "姿勢安定性（Postural Stability）",
        "description": "患者の肩を後方に素早く強く引いて反応を検査。後方への歩数を観察",
        "scores": {
            0: "正常：問題なし。1-2歩で回復",
            1: "軽度：3-5歩だが、補助なしで回復",
            2: "軽度：5歩以上だが、補助なしで回復",
            3: "中等度：安全に立っているが、姿勢反応がない。検査者が捕まえなければ転倒",
            4: "重度：非常に不安定、自然にバランスを失う傾向がある、または肩を軽く引いただけでバランスを失う"
        }
    },
    "3.13": {
        "name": "姿勢（Posture）",
        "description": "椅子から立ち上がった後、歩行中、姿勢反射検査中の姿勢を評価。前屈と側屈を観察",
        "scores": {
            0: "正常：問題なし",
            1: "軽度：完全に直立していないが、高齢者では正常な姿勢の可能性",
            2: "軽度：明確な前屈、側弯、または一側への傾きがあるが、患者は要求すれば正常姿勢に修正できる",
            3: "中等度：前屈姿勢、側弯、または一側への傾きがあり、患者が意図的に正常姿勢に修正できない",
            4: "重度：極度の姿勢異常を伴う前屈、側弯、または傾き"
        }
    },
    "3.14": {
        "name": "全体的な自発運動（Global Spontaneity of Movement）",
        "description": "緩慢、躊躇、振幅の小ささ、運動の貧困さを総合的に評価。座位での自発的なジェスチャー、立ち上がり、歩行を観察",
        "scores": {
            0: "正常：問題なし",
            1: "軽度：自発運動の軽度の全体的な緩慢と貧困",
            2: "軽度：自発運動の軽度の全体的な緩慢と貧困",
            3: "中等度：自発運動の中等度の全体的な緩慢と貧困",
            4: "重度：自発運動の重度の全体的な緩慢と貧困"
        }
    },
    "3.15_r": {
        "name": "姿勢時振戦 - 右手（Postural Tremor - Right）",
        "description": "腕を前方に伸ばし、手のひらを下に向けて10秒間保持。この姿勢で現れるすべての振戦を評価",
        "scores": {
            0: "正常：振戦なし",
            1: "軽度：振戦は存在するが振幅1cm未満",
            2: "軽度：振幅1cm以上3cm未満",
            3: "中等度：振幅3cm以上10cm未満",
            4: "重度：振幅10cm以上"
        }
    },
    "3.15_l": {
        "name": "姿勢時振戦 - 左手（Postural Tremor - Left）",
        "description": "腕を前方に伸ばし、手のひらを下に向けて10秒間保持。この姿勢で現れるすべての振戦を評価",
        "scores": {
            0: "正常：振戦なし",
            1: "軽度：振戦は存在するが振幅1cm未満",
            2: "軽度：振幅1cm以上3cm未満",
            3: "中等度：振幅3cm以上10cm未満",
            4: "重度：振幅10cm以上"
        }
    },
    "3.16_r": {
        "name": "動作時振戦 - 右手（Kinetic Tremor - Right）",
        "description": "指鼻試験を少なくとも3回実施。動作中または目標到達時の振戦を評価",
        "scores": {
            0: "正常：振戦なし",
            1: "軽度：振戦は存在するが振幅1cm未満",
            2: "軽度：振幅1cm以上3cm未満",
            3: "中等度：振幅3cm以上10cm未満",
            4: "重度：振幅10cm以上"
        }
    },
    "3.16_l": {
        "name": "動作時振戦 - 左手（Kinetic Tremor - Left）",
        "description": "指鼻試験を少なくとも3回実施。動作中または目標到達時の振戦を評価",
        "scores": {
            0: "正常：振戦なし",
            1: "軽度：振戦は存在するが振幅1cm未満",
            2: "軽度：振幅1cm以上3cm未満",
            3: "中等度：振幅3cm以上10cm未満",
            4: "重度：振幅10cm以上"
        }
    },
    "3.17_rue": {
        "name": "安静時振戦振幅 - 右上肢（Rest Tremor Amplitude - RUE）",
        "description": "椅子に座り、腕を肘掛けに置いて10秒間観察。検査中のいずれかの時点で見られた最大振幅を評価",
        "scores": {
            0: "正常：振戦なし",
            1: "軽度：最大振幅1cm未満",
            2: "軽度：最大振幅1cm以上3cm未満",
            3: "中等度：最大振幅3cm以上10cm未満",
            4: "重度：最大振幅10cm以上"
        }
    },
    "3.17_lue": {
        "name": "安静時振戦振幅 - 左上肢（Rest Tremor Amplitude - LUE）",
        "description": "椅子に座り、腕を肘掛けに置いて10秒間観察。検査中のいずれかの時点で見られた最大振幅を評価",
        "scores": {
            0: "正常：振戦なし",
            1: "軽度：最大振幅1cm未満",
            2: "軽度：最大振幅1cm以上3cm未満",
            3: "中等度：最大振幅3cm以上10cm未満",
            4: "重度：最大振幅10cm以上"
        }
    },
    "3.17_rle": {
        "name": "安静時振戦振幅 - 右下肢（Rest Tremor Amplitude - RLE）",
        "description": "椅子に座り、足を床に置いて観察。検査中のいずれかの時点で見られた最大振幅を評価",
        "scores": {
            0: "正常：振戦なし",
            1: "軽度：最大振幅1cm未満",
            2: "軽度：最大振幅1cm以上3cm未満",
            3: "中等度：最大振幅3cm以上10cm未満",
            4: "重度：最大振幅10cm以上"
        }
    },
    "3.17_lle": {
        "name": "安静時振戦振幅 - 左下肢（Rest Tremor Amplitude - LLE）",
        "description": "椅子に座り、足を床に置いて観察。検査中のいずれかの時点で見られた最大振幅を評価",
        "scores": {
            0: "正常：振戦なし",
            1: "軽度：最大振幅1cm未満",
            2: "軽度：最大振幅1cm以上3cm未満",
            3: "中等度：最大振幅3cm以上10cm未満",
            4: "重度：最大振幅10cm以上"
        }
    },
    "3.17_lip_jaw": {
        "name": "安静時振戦振幅 - 口唇/顎（Rest Tremor Amplitude - Lip/Jaw）",
        "description": "検査中のいずれかの時点で見られた口唇/顎の最大振幅を評価",
        "scores": {
            0: "正常：振戦なし",
            1: "軽度：最大振幅1cm未満",
            2: "軽度：最大振幅1cm以上2cm未満",
            3: "中等度：最大振幅2cm以上3cm未満",
            4: "重度：最大振幅3cm以上"
        }
    },
    "3.18": {
        "name": "安静時振戦の持続性（Constancy of Rest Tremor）",
        "description": "検査期間中の安静時振戦の持続性に焦点を当てて評価",
        "scores": {
            0: "正常：振戦なし",
            1: "軽度：安静時振戦は検査期間全体の25%以下",
            2: "軽度：安静時振戦は検査期間全体の26-50%",
            3: "中等度：安静時振戦は検査期間全体の51-75%",
            4: "重度：安静時振戦は検査期間全体の75%超"
        }
    }
}

# サブタイプ分類に使用する項目の定義
# 振戦スコア用項目（MDS-UPDRS版）
TREMOR_ITEMS = [
    "3.15_r", "3.15_l",  # 姿勢時振戦
    "3.16_r", "3.16_l",  # 動作時振戦
    "3.17_rue", "3.17_lue", "3.17_rle", "3.17_lle", "3.17_lip_jaw",  # 安静時振戦振幅
    "3.18"  # 安静時振戦の持続性
]

# 無動固縮スコア用項目（MDS-UPDRS版）
AKINETIC_RIGID_ITEMS = [
    "3.1",  # 言語
    "3.2",  # 顔面表情
    "3.3_neck", "3.3_rue", "3.3_lue", "3.3_rle", "3.3_lle",  # 固縮
    "3.4_r", "3.4_l",  # 指タッピング
    "3.5_r", "3.5_l",  # 手の動作
    "3.6_r", "3.6_l",  # 回内回外運動
    "3.7_r", "3.7_l",  # つま先タッピング
    "3.8_r", "3.8_l",  # 下肢の敏捷性
    "3.9",  # 椅子からの立ち上がり
    "3.10",  # 歩行
    "3.11",  # 歩行時のすくみ足
    "3.12",  # 姿勢安定性
    "3.13",  # 姿勢
    "3.14"  # 全体的な自発運動
]

# 評価項目の順序（UI表示用）
ITEM_ORDER = [
    "3.1", "3.2",
    "3.3_neck", "3.3_rue", "3.3_lue", "3.3_rle", "3.3_lle",
    "3.4_r", "3.4_l",
    "3.5_r", "3.5_l",
    "3.6_r", "3.6_l",
    "3.7_r", "3.7_l",
    "3.8_r", "3.8_l",
    "3.9", "3.10", "3.11", "3.12", "3.13", "3.14",
    "3.15_r", "3.15_l",
    "3.16_r", "3.16_l",
    "3.17_rue", "3.17_lue", "3.17_rle", "3.17_lle", "3.17_lip_jaw",
    "3.18"
]
